<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <link rel="stylesheet" href="/css/styles-manager.css"> -->
    <title>Update Quotes</title>
</head>

<body>
    
    <header>
        <div class="dash-header">
            <a href="/dashboard/manager">Dashboard</a>
    
            <h1>Welcome Sales Manager, .....
                <!----this is where the user name goes-->
            </h1>
    
            <a href="/login">Logout</a>
        </div>
    
        </header>


    <div class="testbox-sales">
    
        <form action="/api/quotes/update" method="POST">
            <div class="accounttype">
                <h3>Edit Quote</h3>
                <hr>
            </div>
    
            <!-- display customer name -->    
            <strong>
                <%= cust.name %>
                <%= cust.city %>
                <%= cust.street %>
                <%= cust.address %>
                <!-- insert customer email here -->
            </strong>
    
    
    
            <!-- change customer email-->
            <div>
                <label id="icon" for="cust_email"><i class="fas fa-envelope"></i></label>
                <input type="email" id="cust_email" name="cust_email" placeholder="Enter e-mail Address" size="20"
                    maxlength="20" value="<%= qte.cust_email %>" required>
            </div>
    
    
    
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    
            <!-- add new line items -->
            <h4>Line Items</h4>
    
            <!-- display current line items -->
            <div class="output_fields_wrap_line">
                <% line_items.forEach(function(line_item) { %>
                    <div class="line_items_list_current">
                        <div>
                            <label>Label: </label>
                            <input type="text" value="<%= line_item.label %>" id="line_items" class="line_items"
                                name="line_items">
                            <label>Price: </label>
                            <input type="number" value="<%= line_item.price %>" id="price" class="price" name="price">
                        </div>
                        <button type="submit" class="remove_field_line">Remove Line Item</button>
                    </div>
                    <% }) %>
            </div>
    
  
    
    
    
            <!-- add secret notes -->
            <h4>Secret Notes </h4>
    
    
            <!-- display current secret notes -->
            <div class="output_fields_wrap_note">
                <% secret_notes.forEach(function(note) { %>
                    <div class="secret_notes_list_current">
                        <div>
                            <input type="text" value="<%= note.note %>" id="secret" class="secret" name="secret">
                        </div>
                        <button type="submit" class="remove_field_note">Remove Secret Note</button>
                    </div>
                    <% }) %>
            </div>
    
    
   
    
            <!-- calculate total with discount -->
            <h4>Discount</h4>
            <div class="quote-price">
    
                <label for="discount">Discount: </label>
                <input type="number" class="form-control" name="discount" min="0" step="0.01" id="discount">
    
                <button onclick="getPercentage()">Percentage</button>
                <button onclick="getAmount()">Amount</button>
    
    
                <input readonly id="total" value="<%= qte.total %>" step="0.01" name="total" min="0">
    
            </div>
    
            <div>
                <label for="user_name">Sign your quote:</label>
                <input type="text" id="user_name" name="user_name" placeholder="Enter username" required>
            </div>
    
    
            <element hidden><input type="text" id="quote_id" name="quote_id" value="<%= qte.id %>"></element>
            <button type="submit">Update Quote</button>
        </form>
</body>

<script>


    function getPercentage() {
        var price = Number(document.getElementById("total").value);
        var percent = Number(document.getElementById("discount").value) / 100;
        var totalValue = price - (price * percent);
        document.getElementById("total").value = totalValue.toFixed(2);
    }

    function getAmount() {
        var price = Number(document.getElementById("total").value);
        var amount = Number(document.getElementById("discount").value);
        var totalValue = price - amount;

        if (totalValue <= 0.00) {
            totalValue = 0.00;
            document.getElementById("total").value = totalValue.toFixed(2);
        }
        else {
            document.getElementById("total").value = totalValue.toFixed(2);
        }
    }



</script>


</html>